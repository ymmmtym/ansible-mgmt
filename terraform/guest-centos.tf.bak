resource "esxi_guest" "centos7" {
  guest_name         = "centos7"
  power              = "on"
  disk_store         = var.DISK_STORE
  clone_from_vm      = "template-centos7"
  memsize            = "1024"
  numvcpus           = "1"
  boot_disk_size     = "10"
  network_interfaces {
    virtual_network  = esxi_portgroup.portgroup100_1.name
    mac_address      = "00:50:56:00:64:04"
  }
  network_interfaces {
    virtual_network  = esxi_portgroup.portgroup101_1.name
    mac_address      = "00:50:56:00:65:04"
  }
  guestinfo = {
    "userdata.encoding" = "gzip+base64"
    "userdata"          = base64gzip(data.template_file.hello_cloud_init.rendered)
  }
}

resource "esxi_guest" "centos8" {
  guest_name         = "centos8"
  power              = "on"
  disk_store         = var.DISK_STORE
  clone_from_vm      = "template-centos8"
  memsize            = "1024"
  numvcpus           = "1"
  boot_disk_size     = "10"
  network_interfaces {
    virtual_network  = esxi_portgroup.portgroup100_1.name
    mac_address      = "00:50:56:00:64:05"
  }
  network_interfaces {
    virtual_network  = esxi_portgroup.portgroup101_1.name
    mac_address      = "00:50:56:00:65:05"
  }
  guestinfo = {
    "userdata.encoding" = "gzip+base64"
    "userdata"          = base64gzip(data.template_file.hello_cloud_init.rendered)
  }
}
